<?xml version="1.0"?>
<!--
  ~ Copyright Â© 2022 TechNWeb, Inc. All rights reserved.
  ~ See TNW_LICENSE.txt for license details.
  -->

<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="urn:magento:framework:ObjectManager/etc/config.xsd">
    <preference for="TNW\Salesforce\Api\WebsiteInterface" type="TNW\Salesforce\Client\Website" />
    <type name="TNW\Salesforce\Client\Salesforce" shared="true" />
    <virtualType name="TNW\Salesforce\Setup\Module\DataSetup" type="Magento\Setup\Module\DataSetup">
        <arguments>
            <argument name="context" xsi:type="object">Magento\Framework\Module\Setup\Context</argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Salesforce\Synchronize\Unit\Load\LoaderAttributes\Customer" type="TNW\Salesforce\Synchronize\Unit\Load\LoaderAttributes">
        <arguments>
            <argument name="magentoType" xsi:type="const">TNW\Salesforce\Model\Mapper::MAGENTO_ENTITY_TYPE_CUSTOMER</argument>
            <argument name="collectionFactoryName" xsi:type="string">Magento\Customer\Model\ResourceModel\Customer\CollectionFactory</argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Salesforce\Service\Synchronize\Unit\Load\PreloadEntities\PreloadAttributes\Customer" type="TNW\Salesforce\Service\Synchronize\Unit\Load\PreloadEntities\PreloadAttributes">
        <arguments>
            <argument name="loaderAttributes" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Load\LoaderAttributes\Customer</argument>
        </arguments>
    </virtualType>

    <type name="Magento\Eav\Setup\EavSetup">
        <arguments>
            <argument name="setup" xsi:type="object">TNW\Salesforce\Setup\Module\DataSetup</argument>
        </arguments>
    </type>

    <preference for="TNW\Salesforce\Api\Model\Cron\Source\MagentoSyncTypeInterface" type="TNW\Salesforce\Model\Cron\Source\MagentoSyncType" />
    <preference for="TNW\Salesforce\Api\Model\Synchronization\ConfigInterface" type="TNW\Salesforce\Model\Synchronization\Config" />
    <preference for="TNW\Salesforce\Api\Model\Prequeue\ProcessInterface" type="TNW\Salesforce\Model\Prequeue\Process" />

    <type name="TNW\Salesforce\Model\Prequeue\Process">
        <arguments>
            <argument name="queueAddPool" xsi:type="array">
                <item name="website" xsi:type="object">TNW\Salesforce\Synchronize\Queue\Website</item>
                <item name="customer" xsi:type="object">TNW\Salesforce\Synchronize\Queue\Customer</item>
            </argument>
        </arguments>
    </type>

    <preference for="Magento\Framework\Interception\Code\Generator\Interceptor" type="TNW\Salesforce\Code\Generator\Interceptor" />
    <!-- Workaround for Magento bug, see https://github.com/magento/magento2/pull/26475 -->
    <preference for="Magento\Customer\Model\Customer\Attribute\Source\Store" type="TNW\Salesforce\Model\Customer\Attribute\Source\Store" />

    <preference for="TNW\Salesforce\Synchronize\Unit\IdentificationInterface" type="TNW\Salesforce\Synchronize\Unit\Identification" />
    <preference for="TNW\Salesforce\Synchronize\Unit\HashInterface" type="TNW\Salesforce\Synchronize\Unit\Hash" />

    <preference for="TNW\Salesforce\Synchronize\Transport\Calls\QueryInterface" type="TNW\Salesforce\Synchronize\Transport\Soap\Calls\Query" />
    <preference for="TNW\Salesforce\Synchronize\Transport\Calls\Upsert\InputInterface" type="TNW\Salesforce\Synchronize\Transport\Soap\Calls\Upsert\Input" />
    <preference for="TNW\Salesforce\Synchronize\Transport\Calls\Upsert\OutputInterface" type="TNW\Salesforce\Synchronize\Transport\Soap\Calls\Upsert\Output" />

    <preference for="TNW\Salesforce\Synchronize\Transport\Calls\Delete\InputInterface" type="TNW\Salesforce\Synchronize\Transport\Soap\Calls\Delete\Input" />
    <preference for="TNW\Salesforce\Synchronize\Transport\Calls\Delete\OutputInterface" type="TNW\Salesforce\Synchronize\Transport\Soap\Calls\Delete\Output" />

    <type name="TNW\Salesforce\Model\ResourceModel\FilterBlockedQueueRecords">
        <arguments>
            <argument name="logger" xsi:type="object">TNW\Logger</argument>
            <argument name="processStatuses" xsi:type="const">TNW\Salesforce\Model\Queue::PROCESS_STATUSES</argument>
            <argument name="errorStatuses" xsi:type="const">TNW\Salesforce\Model\Queue::ERROR_STATUSES</argument>
            <argument name="newStatuses" xsi:type="array">
                <item name="new" xsi:type="const">TNW\Salesforce\Model\Queue::STATUS_NEW</item>
            </argument>
        </arguments>
    </type>

    <!-- Salesforce Id Storage -->
    <virtualType name="TNW\Salesforce\Model\Entity\Object\Website" type="TNW\Salesforce\Model\Entity\SalesforceIdStorage">
        <arguments>
            <argument name="magentoType" xsi:type="const">TNW\Salesforce\Model\Entity\SalesforceIdStorage::MAGENTO_TYPE_WEBSITE</argument>
            <argument name="mappingAttribute" xsi:type="array">
                <item name="salesforce_id" xsi:type="string">tnw_mage_basic__Magento_Website__c</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Mapping Loader -->
    <type name="TNW\Salesforce\Synchronize\Unit\Customer\Mapping\Loader\Website">
        <arguments>
            <argument name="salesforceIdStorage" xsi:type="object">TNW\Salesforce\Model\Entity\Object\Website</argument>
            <argument name="loaders" xsi:type="array">
                <item name="10" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Mapping\Loader\Website\Loader</item>
            </argument>
        </arguments>
    </type>

    <virtualType name="TNW\Salesforce\Model\Entity\Object\Customer" type="TNW\Salesforce\Model\Entity\SalesforceIdStorage">
        <arguments>
            <argument name="magentoType" xsi:type="const">TNW\Salesforce\Model\Entity\SalesforceIdStorage::MAGENTO_TYPE_CUSTOMER</argument>
            <argument name="mappingAttribute" xsi:type="array">
                <item name="sforce_account_id" xsi:type="string">Account</item>
                <item name="sforce_id" xsi:type="string">Contact</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Customer\BusinessAccount\Load" type="TNW\Salesforce\Synchronize\Unit\Load">
        <arguments>
            <argument name="name" xsi:type="string">customerLoad</argument>
            <argument name="magentoType" xsi:type="string">customer</argument>
            <argument name="hash" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Hash</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Identification</argument>
            <argument name="entityObject" xsi:type="object">TNW\Salesforce\Model\Entity\Object\Customer</argument>
            <argument name="entityLoaders" xsi:type="array">
                <item name="website" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Mapping\Loader\Website</item>
            </argument>
            <argument name="loaders" xsi:type="array">
                <item name="customer" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Load\Loader\Customer</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Customer\BusinessAccount\ProcessingUpsertInput" type="TNW\Salesforce\Synchronize\Unit\ProcessingUpsertInput">
        <arguments>
            <argument name="name" xsi:type="string">customerBusinessAccountProcessingUpsertInput</argument>
            <argument name="load" xsi:type="string">customerLoad</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Identification</argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Customer\BusinessAccount\Lookup\ByContact" type="TNW\Salesforce\Synchronize\Unit\Customer\Account\Lookup\ByContact">
        <arguments>
            <argument name="name" xsi:type="string">customerBusinessAccountLookupByContact</argument>
            <argument name="load" xsi:type="string">customerLoad</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Identification</argument>
            <argument name="dependents" xsi:type="array">
                <item name="upsertInput" xsi:type="string">customerBusinessAccountProcessingUpsertInput</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Customer\BusinessAccount\Lookup\ByName" type="TNW\Salesforce\Synchronize\Unit\Customer\Account\Lookup\ByName">
        <arguments>
            <argument name="name" xsi:type="string">customerBusinessAccountLookupByName</argument>
            <argument name="load" xsi:type="string">customerLoad</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Identification</argument>
            <argument name="dependents" xsi:type="array">
                <item name="upsertInput" xsi:type="string">customerBusinessAccountProcessingUpsertInput</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Customer\BusinessAccount\Lookup" type="TNW\Salesforce\Synchronize\Unit\Collect">
        <arguments>
            <argument name="name" xsi:type="string">lookup</argument>
            <argument name="collect" xsi:type="array">
                <item name="10" xsi:type="string">customerBusinessAccountLookupByContact</item>
                <item name="20" xsi:type="string">customerBusinessAccountLookupByName</item>
            </argument>
<!--            <argument name="units" xsi:type="array">-->
<!--                <item name="customerBusinessAccountLookupByContact" xsi:type="string">TNW\Unit\Customer\BusinessAccount\Lookup\ByContact</item>-->
<!--                <item name="customerBusinessAccountLookupByName" xsi:type="string">TNW\Unit\Customer\BusinessAccount\Lookup\ByName</item>-->
<!--            </argument>-->
        </arguments>
    </virtualType>

    <type name="TNW\Salesforce\Synchronize\Unit\Mapping">
        <plugin name="tnw_salesforce_mapping_customer_group"
                type="TNW\Salesforce\Plugin\Synchronize\Unit\Mapping\Customer\Group" />
        <plugin name="tnw_salesforce_check_owner_field"
                type="TNW\Salesforce\Plugin\Synchronize\Unit\Mapping\CheckOwnerField" />
    </type>

    <type name="TNW\Salesforce\Plugin\Magento\MessageQueue\Console\StartConsumerCommand">
        <arguments>
            <argument name="consumers" xsi:type="array">
                <item name="tnwSalesforceSyncRealtimeAmqp" xsi:type="string">tnwSalesforceSyncRealtimeAmqp</item>
                <item name="tnwSalesforceSyncRealtimeDb" xsi:type="string">tnwSalesforceSyncRealtimeDb</item>
                <item name="tnwSalesforcePrequeueProcessDb" xsi:type="string">tnwSalesforcePrequeueProcessDb</item>
                <item name="tnwSalesforcePrequeueProcessAmqp" xsi:type="string">tnwSalesforcePrequeueProcessAmqp</item>
            </argument>
        </arguments>
    </type>

    <type name="Magento\MessageQueue\Console\StartConsumerCommand">
        <plugin name="tnw_salesforce"
                type="TNW\Salesforce\Plugin\Magento\MessageQueue\Console\StartConsumerCommand" />
    </type>

    <virtualType name="TNW\Unit\Customer\BusinessAccount\Mapping" type="TNW\Salesforce\Synchronize\Unit\Customer\Account\Mapping">
        <arguments>
            <argument name="name" xsi:type="string">mapping</argument>
            <argument name="load" xsi:type="string">customerLoad</argument>
            <argument name="lookup" xsi:type="string">lookup</argument>
            <argument name="objectType" xsi:type="string">Account</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Identification</argument>
            <argument name="dependents" xsi:type="array">
                <item name="upsertInput" xsi:type="string">customerBusinessAccountProcessingUpsertInput</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Customer\BusinessAccount\UpsertInput" type="TNW\Salesforce\Synchronize\Unit\Customer\Account\Upsert\Input">
        <arguments>
            <argument name="name" xsi:type="string">upsertInput</argument>
            <argument name="load" xsi:type="string">customerLoad</argument>
            <argument name="mapping" xsi:type="string">mapping</argument>
            <argument name="salesforceType" xsi:type="string">Account</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Identification</argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Customer\BusinessAccount\ProcessingUpsertOutput" type="TNW\Salesforce\Synchronize\Unit\ProcessingUpsertOutput">
        <arguments>
            <argument name="name" xsi:type="string">customerBusinessAccountProcessingUpsertOutput</argument>
            <argument name="load" xsi:type="string">customerLoad</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Identification</argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Customer\BusinessAccount\UpsertOutput" type="TNW\Salesforce\Synchronize\Unit\Upsert\Output">
        <arguments>
            <argument name="name" xsi:type="string">upsertOutput</argument>
            <argument name="load" xsi:type="string">customerLoad</argument>
            <argument name="upsertInput" xsi:type="string">upsertInput</argument>
            <argument name="salesforceType" xsi:type="string">Account</argument>
            <argument name="fieldSalesforceId" xsi:type="string">sforce_account_id</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Identification</argument>
            <argument name="dependents" xsi:type="array">
                <item name="processUpsertOutput" xsi:type="string">customerBusinessAccountProcessingUpsertOutput</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Customer\BusinessAccount\Save" type="TNW\Salesforce\Synchronize\Unit\Save">
        <arguments>
            <argument name="name" xsi:type="string">save</argument>
            <argument name="load" xsi:type="string">customerLoad</argument>
            <argument name="fieldModifier" xsi:type="string">upsertOutput</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Identification</argument>
            <argument name="entityObject" xsi:type="object">TNW\Salesforce\Model\Entity\Object\Customer</argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Customer\BusinessAccount\Status" type="TNW\Salesforce\Synchronize\Unit\Status">
        <arguments>
            <argument name="name" xsi:type="string">customerBusinessAccountStatus</argument>
            <argument name="load" xsi:type="string">customerLoad</argument>
            <argument name="upsertOutput" xsi:type="string">upsertOutput</argument>
            <argument name="salesforceIdStorage" xsi:type="object">TNW\Salesforce\Model\Entity\Object\Customer</argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Soap\Synchronize\Customer\BusinessAccount" type="TNW\Salesforce\Synchronize\Group">
        <arguments>
            <argument name="groupCode" xsi:type="string">customerBusinessAccount</argument>
            <argument name="units" xsi:type="array">
                <item name="load" xsi:type="string">TNW\Unit\Customer\BusinessAccount\Load</item>
                <item name="processingUpsertInput" xsi:type="string">TNW\Unit\Customer\BusinessAccount\ProcessingUpsertInput</item>
<!--                -->
                <item name="lookupByContact" xsi:type="string">TNW\Unit\Customer\BusinessAccount\Lookup\ByContact</item>
                <item name="lookupByName" xsi:type="string">TNW\Unit\Customer\BusinessAccount\Lookup\ByName</item>
                <item name="lookup" xsi:type="string">TNW\Unit\Customer\BusinessAccount\Lookup</item>
                <item name="mapping" xsi:type="string">TNW\Unit\Customer\BusinessAccount\Mapping</item>
                <item name="upsertInput" xsi:type="string">TNW\Unit\Customer\BusinessAccount\UpsertInput</item>
                <item name="processingUpsertOutput" xsi:type="string">TNW\Unit\Customer\BusinessAccount\ProcessingUpsertOutput</item>
                <item name="upsertOutput" xsi:type="string">TNW\Unit\Customer\BusinessAccount\UpsertOutput</item>
                <item name="save" xsi:type="string">TNW\Customer\BusinessAccount\Save</item>
                <item name="status" xsi:type="string">TNW\Unit\Customer\BusinessAccount\Status</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Customer\Contact\Load" type="TNW\Salesforce\Synchronize\Unit\Load">
        <arguments>
            <argument name="name" xsi:type="string">customerLoad</argument>
            <argument name="magentoType" xsi:type="string">customer</argument>
            <argument name="hash" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Hash</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Identification</argument>
            <argument name="entityObject" xsi:type="object">TNW\Salesforce\Model\Entity\Object\Customer</argument>
            <argument name="entityLoaders" xsi:type="array">
                <item name="website" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Mapping\Loader\Website</item>
                <item name="customer" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Mapping\Loader\Customer</item>
            </argument>
            <argument name="loaders" xsi:type="array">
                <item name="customer" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Load\Loader\Customer</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Customer\Contact\ProcessingUpsertInput" type="TNW\Salesforce\Synchronize\Unit\ProcessingUpsertInput">
        <arguments>
            <argument name="name" xsi:type="string">customerContactProcessingUpsertInput</argument>
            <argument name="load" xsi:type="string">customerLoad</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Identification</argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Customer\Contact\Lookup" type="TNW\Salesforce\Synchronize\Unit\Customer\Contact\Lookup">
        <arguments>
            <argument name="name" xsi:type="string">lookup</argument>
            <argument name="load" xsi:type="string">customerLoad</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Identification</argument>
<!--            <argument name="dependents" xsi:type="array">-->
<!--                <item name="processUpsertInput" xsi:type="string">customerContactProcessingUpsertInput</item>-->
<!--            </argument>-->
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Customer\Contact\Mapping" type="TNW\Salesforce\Synchronize\Unit\Customer\Contact\Mapping">
        <arguments>
            <argument name="name" xsi:type="string">mapping</argument>
            <argument name="load" xsi:type="string">customerLoad</argument>
            <argument name="lookup" xsi:type="string">lookup</argument>
            <argument name="objectType" xsi:type="string">Contact</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Identification</argument>
            <argument name="dependents" xsi:type="array">
                <item name="processUpsertInput" xsi:type="string">customerContactProcessingUpsertInput</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Customer\Contact\UpsertInput" type="TNW\Salesforce\Synchronize\Unit\Upsert\Input">
        <arguments>
            <argument name="name" xsi:type="string">upsertInput</argument>
            <argument name="load" xsi:type="string">customerLoad</argument>
            <argument name="mapping" xsi:type="string">mapping</argument>
            <argument name="salesforceType" xsi:type="string">Contact</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Identification</argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Customer\Contact\ProcessingUpsertOutput" type="TNW\Salesforce\Synchronize\Unit\ProcessingUpsertOutput">
        <arguments>
            <argument name="name" xsi:type="string">customerContactProcessingUpsertOutput</argument>
            <argument name="load" xsi:type="string">customerLoad</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Identification</argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Customer\Contact\UpsertOutput" type="TNW\Salesforce\Synchronize\Unit\Upsert\Output">
        <arguments>
            <argument name="name" xsi:type="string">upsertOutput</argument>
            <argument name="load" xsi:type="string">customerLoad</argument>
            <argument name="upsertInput" xsi:type="string">upsertInput</argument>
            <argument name="salesforceType" xsi:type="string">Contact</argument>
            <argument name="fieldSalesforceId" xsi:type="string">sforce_id</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Identification</argument>
            <argument name="dependents" xsi:type="array">
                <item name="processUpsertOutput" xsi:type="string">customerContactProcessingUpsertOutput</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Customer\Contact\Save" type="TNW\Salesforce\Synchronize\Unit\Save">
        <arguments>
            <argument name="name" xsi:type="string">save</argument>
            <argument name="load" xsi:type="string">customerLoad</argument>
            <argument name="fieldModifier" xsi:type="string">upsertOutput</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Customer\Identification</argument>
            <argument name="entityObject" xsi:type="object">TNW\Salesforce\Model\Entity\Object\Customer</argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Customer\Contact\Status" type="TNW\Salesforce\Synchronize\Unit\Status">
        <arguments>
            <argument name="name" xsi:type="string">customerContactStatus</argument>
            <argument name="load" xsi:type="string">customerLoad</argument>
            <argument name="upsertOutput" xsi:type="string">upsertOutput</argument>
            <argument name="salesforceIdStorage" xsi:type="object">TNW\Salesforce\Model\Entity\Object\Customer</argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Soap\Synchronize\Customer\Contact" type="TNW\Salesforce\Synchronize\Group">
        <arguments>
            <argument name="groupCode" xsi:type="string">customerContact</argument>
            <argument name="units" xsi:type="array">
                <item name="load" xsi:type="string">TNW\Unit\Customer\Contact\Load</item>
                <item name="processingUpsertInput" xsi:type="string">TNW\Unit\Customer\Contact\ProcessingUpsertInput</item>
                <item name="lookup" xsi:type="string">TNW\Unit\Customer\Contact\Lookup</item>
                <item name="mapping" xsi:type="string">TNW\Unit\Customer\Contact\Mapping</item>
                <item name="upsertInput" xsi:type="string">TNW\Unit\Customer\Contact\UpsertInput</item>
                <item name="processingUpsertOutput" xsi:type="string">TNW\Unit\Customer\Contact\ProcessingUpsertOutput</item>
                <item name="upsertOutput" xsi:type="string">TNW\Unit\Customer\Contact\UpsertOutput</item>
                <item name="save" xsi:type="string">TNW\Customer\Contact\Save</item>
                <item name="status" xsi:type="string">TNW\Unit\Customer\Contact\Status</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Website\Website\Load" type="TNW\Salesforce\Synchronize\Unit\Load">
        <arguments>
            <argument name="name" xsi:type="string">websiteLoad</argument>
            <argument name="magentoType" xsi:type="string">website</argument>
            <argument name="hash" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Website\Hash</argument>
            <argument name="entityObject" xsi:type="object">TNW\Salesforce\Model\Entity\Object\Website</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Website\Identification</argument>
            <argument name="loaders" xsi:type="array">
                <item name="website" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Website\Loader\ByWebsite</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Website\Website\ProcessingUpsertInput" type="TNW\Salesforce\Synchronize\Unit\ProcessingUpsertInput">
        <arguments>
            <argument name="name" xsi:type="string">websiteWebsiteProcessingUpsertInput</argument>
            <argument name="load" xsi:type="string">websiteLoad</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Website\Identification</argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Website\Website\Lookup" type="TNW\Salesforce\Synchronize\Unit\Website\Website\Lookup">
        <arguments>
            <argument name="name" xsi:type="string">lookup</argument>
            <argument name="load" xsi:type="string">websiteLoad</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Website\Identification</argument>
<!--            <argument name="dependents" xsi:type="array">-->
<!--                <item name="upsertInput" xsi:type="string">websiteWebsiteProcessingUpsertInput</item>-->
<!--            </argument>-->
        </arguments>
    </virtualType>

    <type name="TNW\Salesforce\Synchronize\Unit\Website\Website\Mapping">
        <arguments>
            <argument name="name" xsi:type="string">mapping</argument>
            <argument name="load" xsi:type="string">websiteLoad</argument>
            <argument name="lookup" xsi:type="string">lookup</argument>
            <argument name="objectType" xsi:type="string">Website</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Website\Identification</argument>
            <argument name="dependents" xsi:type="array">
                <item name="upsertInput" xsi:type="string">websiteWebsiteProcessingUpsertInput</item>
            </argument>
        </arguments>
    </type>

    <virtualType name="TNW\Unit\Website\Website\UpsertInput" type="TNW\Salesforce\Synchronize\Unit\Upsert\Input">
        <arguments>
            <argument name="name" xsi:type="string">upsertInput</argument>
            <argument name="load" xsi:type="string">websiteLoad</argument>
            <argument name="mapping" xsi:type="string">mapping</argument>
            <argument name="salesforceType" xsi:type="string">tnw_mage_basic__Magento_Website__c</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Website\Identification</argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Website\Website\ProcessingUpsertOutput" type="TNW\Salesforce\Synchronize\Unit\ProcessingUpsertOutput">
        <arguments>
            <argument name="name" xsi:type="string">websiteWebsiteProcessingUpsertOutput</argument>
            <argument name="load" xsi:type="string">websiteLoad</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Website\Identification</argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Website\Website\UpsertOutput" type="TNW\Salesforce\Synchronize\Unit\Upsert\Output">
        <arguments>
            <argument name="name" xsi:type="string">upsertOutput</argument>
            <argument name="load" xsi:type="string">websiteLoad</argument>
            <argument name="upsertInput" xsi:type="string">upsertInput</argument>
            <argument name="salesforceType" xsi:type="string">tnw_mage_basic__Magento_Website__c</argument>
            <argument name="fieldSalesforceId" xsi:type="string">salesforce_id</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Website\Identification</argument>
            <argument name="dependents" xsi:type="array">
                <item name="upsertInput" xsi:type="string">websiteWebsiteProcessingUpsertOutput</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Website\Website\Save" type="TNW\Salesforce\Synchronize\Unit\Save">
        <arguments>
            <argument name="name" xsi:type="string">save</argument>
            <argument name="load" xsi:type="string">websiteLoad</argument>
            <argument name="fieldModifier" xsi:type="string">upsertOutput</argument>
            <argument name="entityObject" xsi:type="object">TNW\Salesforce\Model\Entity\Object\Website</argument>
            <argument name="identification" xsi:type="object">TNW\Salesforce\Synchronize\Unit\Website\Identification</argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Unit\Website\Website\Status" type="TNW\Salesforce\Synchronize\Unit\Status">
        <arguments>
            <argument name="name" xsi:type="string">websiteWebsiteStatus</argument>
            <argument name="load" xsi:type="string">websiteLoad</argument>
            <argument name="upsertOutput" xsi:type="string">upsertOutput</argument>
            <argument name="salesforceIdStorage" xsi:type="object">TNW\Salesforce\Model\Entity\Object\Website</argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Soap\Synchronize\Website\Website" type="TNW\Salesforce\Synchronize\Group">
        <arguments>
            <argument name="groupCode" xsi:type="string">websiteWebsite</argument>
            <argument name="units" xsi:type="array">
                <item name="load" xsi:type="string">TNW\Unit\Website\Website\Load</item>
                <item name="processingUpsertInput" xsi:type="string">TNW\Unit\Website\Website\ProcessingUpsertInput</item>
                <item name="lookup" xsi:type="string">TNW\Unit\Website\Website\Lookup</item>
                <item name="mapping" xsi:type="string">TNW\Salesforce\Synchronize\Unit\Website\Website\Mapping</item>
                <item name="upsertInput" xsi:type="string">TNW\Unit\Website\Website\UpsertInput</item>
                <item name="processingUpsertOutput" xsi:type="string">TNW\Unit\Website\Website\ProcessingUpsertOutput</item>
                <item name="upsertOutput" xsi:type="string">TNW\Unit\Website\Website\UpsertOutput</item>
                <item name="save" xsi:type="string">TNW\Unit\Website\Website\Save</item>
                <item name="status" xsi:type="string">TNW\Unit\Website\Website\Status</item>
            </argument>
        </arguments>
    </virtualType>

    <type name="TNW\Salesforce\Controller\Adminhtml\Customer\SyncCustomer">
        <arguments>
            <argument name="entityCustomer" xsi:type="object">TNW\Salesforce\Synchronize\Queue\Customer</argument>
        </arguments>
    </type>
    <type name="TNW\Salesforce\Controller\Adminhtml\Customer\MassSync">
        <arguments>
            <argument name="entityCustomer" xsi:type="object">TNW\Salesforce\Synchronize\Queue\Customer</argument>
        </arguments>
    </type>
    <virtualType name="TNW\Salesforce\Observer\Entities\Customer" type="TNW\Salesforce\Observer\Entities" />
    <virtualType name="TNW\Salesforce\Observer\CustomerEntitiesSync" type="TNW\Salesforce\Observer\EntitiesSync">
        <arguments>
            <argument name="entities" xsi:type="object">TNW\Salesforce\Observer\Entities\Customer</argument>
            <argument name="entityQueue" xsi:type="object">TNW\Salesforce\Synchronize\Queue\Customer</argument>
        </arguments>
    </virtualType>
    <type name="TNW\Salesforce\Observer\CustomerSaveCommitAfter">
        <arguments>
            <argument name="entities" xsi:type="object">TNW\Salesforce\Observer\Entities\Customer</argument>
        </arguments>
    </type>
    <type name="TNW\Salesforce\Observer\CustomerAddressSaveCommitAfter">
        <arguments>
            <argument name="entities" xsi:type="object">TNW\Salesforce\Observer\Entities\Customer</argument>
        </arguments>
    </type>

    <type name="TNW\Salesforce\Controller\Adminhtml\System\Store\SyncAll">
        <arguments>
            <argument name="entityWebsite" xsi:type="object">TNW\Salesforce\Synchronize\Queue\Website</argument>
        </arguments>
    </type>
    <virtualType name="TNW\Salesforce\Observer\Entities\Website" type="TNW\Salesforce\Observer\Entities" />
    <virtualType name="TNW\Salesforce\Observer\WebsiteEntitiesSync" type="TNW\Salesforce\Observer\EntitiesSync">
        <arguments>
            <argument name="entities" xsi:type="object">TNW\Salesforce\Observer\Entities\Website</argument>
            <argument name="entityQueue" xsi:type="object">TNW\Salesforce\Synchronize\Queue\Website</argument>
        </arguments>
    </virtualType>
    <type name="TNW\Salesforce\Observer\WebsiteSaveCommitAfter">
        <arguments>
            <argument name="entities" xsi:type="object">TNW\Salesforce\Observer\Entities\Website</argument>
        </arguments>
    </type>

    <virtualType name="TNW\Logger" type="Monolog\Logger">
        <arguments>
            <argument name="name" xsi:type="string">tnw_synchronize</argument>
            <argument name="handlers" xsi:type="array">
                <item name="1" xsi:type="object">TNW\Salesforce\Model\Logger\Handler\Filesystem\Proxy</item>
                <item name="2" xsi:type="object">TNW\Salesforce\Model\Logger\Handler\Database</item>
                <item name="3" xsi:type="object">TNW\Salesforce\Model\Logger\Handler\Admin</item>
            </argument>
            <argument name="processors" xsi:type="array">
                <item name="uid" xsi:type="object">TNW\Salesforce\Model\Logger\Processor\UidProcessor</item>
            </argument>
        </arguments>
    </virtualType>
    <type name="TNW\Salesforce\Model\Logger">
        <arguments>
            <argument name="systemLogger" xsi:type="object">TNW\Logger</argument>
        </arguments>
    </type>
    <type name="TNW\Salesforce\Synchronize\Group">
        <arguments>
            <argument name="systemLogger" xsi:type="object">TNW\Logger</argument>
        </arguments>
    </type>
    <type name="TNW\Salesforce\Synchronize\Queue">
        <arguments>
            <argument name="logger" xsi:type="object">TNW\Logger</argument>
        </arguments>
    </type>
    <type name="TNW\Salesforce\Synchronize\Transport\Soap\ClientFactory">
        <arguments>
            <argument name="logger" xsi:type="object">TNW\Logger</argument>
        </arguments>
    </type>

    <virtualType name="salesforceLogSearchResult" type="Magento\Framework\View\Element\UiComponent\DataProvider\SearchResult">
        <arguments>
            <argument name="mainTable" xsi:type="string">tnw_salesforce_log</argument>
            <argument name="resourceModel" xsi:type="string">\TNW\Salesforce\Model\ResourceModel\Log</argument>
        </arguments>
    </virtualType>
    <type name="Magento\Framework\View\Element\UiComponent\DataProvider\CollectionFactory">
        <arguments>
            <argument name="collections" xsi:type="array">
                <item name="tnw_salesforce_log_data_source" xsi:type="string">salesforceLogSearchResult</item>
            </argument>
        </arguments>
    </type>

    <type name="TNW\Salesforce\Synchronize\Entity\DivideEntityByWebsiteOrg\Pool">
        <arguments>
            <argument name="dividers" xsi:type="array">
                <item name="website" xsi:type="object">TNW\Salesforce\Synchronize\Entity\DivideEntityByWebsiteOrg\Website</item>
                <item name="customer" xsi:type="object">TNW\Salesforce\Synchronize\Entity\DivideEntityByWebsiteOrg\Customer</item>
            </argument>
        </arguments>
    </type>

    <type name="Magento\Store\Model\StoreManager">
        <plugin name="tnw_salesforce" type="TNW\Salesforce\Plugin\Store\StoreManager" sortOrder="10" />
    </type>

    <type name="TNW\Salesforce\Synchronize\Queue\Add">
        <arguments>
            <argument name="synchronizeEntity" xsi:type="object">TNW\Synchronize\Queue\Realtime</argument>
        </arguments>
        <plugin name="tnw_salesforce_pending_status" type="TNW\Salesforce\Plugin\Synchronize\Queue\Add" sortOrder="10"/>
    </type>

    <type name="TNW\Salesforce\Model\Queue\Synchronize\Message\ProcessQueueMessage">
        <arguments>
            <argument name="synchronizeEntity" xsi:type="object">TNW\Synchronize\Queue\Realtime</argument>
        </arguments>
    </type>

    <virtualType name="TNW\Synchronize\Queue\Realtime" type="TNW\Salesforce\Synchronize\Queue\Synchronize">
        <arguments>
            <argument name="type" xsi:type="const">TNW\Salesforce\Model\Config::DIRECT_SYNC_TYPE_REALTIME</argument>
            <argument name="synchronizeQueue" xsi:type="object">TNW\Soap\Synchronize\Queue</argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Soap\Synchronize\Queue" type="TNW\Salesforce\Synchronize\Queue">
        <arguments>
            <argument name="phases" xsi:type="array">
                <item name="-1" xsi:type="array">
                    <item name="phaseName" xsi:type="string" translatable="true">Output error records</item>
                    <item name="startStatus" xsi:type="const">TNW\Salesforce\Model\Queue::STATUS_ERROR</item>
                    <item name="processStatus" xsi:type="const">TNW\Salesforce\Model\Queue::STATUS_PROCESS_INPUT_UPSERT</item>
                    <item name="errorStatus" xsi:type="const">TNW\Salesforce\Model\Queue::STATUS_ERROR</item>
                </item>
                <item name="0" xsi:type="array">
                    <item name="phaseName" xsi:type="string" translatable="true">Upsert</item>
                    <item name="startStatus" xsi:type="const">TNW\Salesforce\Model\Queue::STATUS_NEW</item>
                    <item name="processStatus" xsi:type="const">TNW\Salesforce\Model\Queue::STATUS_PROCESS_INPUT_UPSERT</item>
                    <item name="errorStatus" xsi:type="const">TNW\Salesforce\Model\Queue::STATUS_ERROR</item>
                </item>
            </argument>
            <argument name="groups" xsi:type="array">
                <item name="customerBusinessAccount" xsi:type="object">TNW\Soap\Synchronize\Customer\BusinessAccount</item>
                <item name="customerContact" xsi:type="object">TNW\Soap\Synchronize\Customer\Contact</item>
                <item name="websiteWebsite" xsi:type="object">TNW\Soap\Synchronize\Website\Website</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Customer -->
    <virtualType name="TNW\Salesforce\Synchronize\Queue\Customer" type="TNW\Salesforce\Synchronize\Queue\Add">
        <arguments>
            <argument name="entityType" xsi:type="string">customer</argument>
            <argument name="resolves" xsi:type="array">
                <item name="businessAccount" xsi:type="object">TS\Queue\Unit\Customer\BusinessAccount</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="TS\Queue\Unit\Customer\BusinessAccount" type="TNW\Salesforce\Synchronize\Queue\Unit">
        <arguments>
            <argument name="code" xsi:type="string">customerBusinessAccount</argument>
            <argument name="description" xsi:type="string" translatable="true">Customer ({{identifier|customer}}). Synchronization of Magento customer data with Salesforce Account object.</argument>
            <argument name="entityType" xsi:type="string">customer</argument>
            <argument name="objectType" xsi:type="string">Account</argument>
            <argument name="generators" xsi:type="array">
                <item name="customer" xsi:type="object">TNW\Salesforce\Synchronize\Queue\Customer\CreateByCustomer</item>
            </argument>
            <argument name="children" xsi:type="array">
                <item name="contact" xsi:type="string">TS\Queue\Unit\Customer\Contact</item>
            </argument>
            <argument name="skipRules" xsi:type="array">
                <item name="skipByCustomerGroupConfiguration" xsi:type="object">TNW\Salesforce\Synchronize\Queue\Customer\SkipRules\SkipByCustomerGroup</item>
                <item name="disabledSync" xsi:type="object">
                    TNW\Salesforce\Synchronize\Queue\Customer\SkipRules\SkipDisabledSync
                </item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="TS\Queue\Unit\Customer\Contact" type="TNW\Salesforce\Synchronize\Queue\Unit">
        <arguments>
            <argument name="code" xsi:type="string">customerContact</argument>
            <argument name="description" xsi:type="string" translatable="true">Customer ({{identifier|customer}}). Synchronization of Magento customer data with Salesforce Contact object.</argument>
            <argument name="entityType" xsi:type="string">customer</argument>
            <argument name="objectType" xsi:type="string">Contact</argument>
            <argument name="generators" xsi:type="array">
                <item name="customer" xsi:type="object">TNW\Salesforce\Synchronize\Queue\Customer\CreateByCustomer</item>
            </argument>
            <argument name="parents" xsi:type="array">
                <item name="businessAccount" xsi:type="string">TS\Queue\Unit\Customer\BusinessAccount</item>
                <item name="website" xsi:type="string">TS\Queue\Unit\Website\Website</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Website -->
    <virtualType name="TNW\Salesforce\Synchronize\Queue\Website" type="TNW\Salesforce\Synchronize\Queue\Add">
        <arguments>
            <argument name="entityType" xsi:type="string">website</argument>
            <argument name="resolves" xsi:type="array">
                <item name="website" xsi:type="object">TS\Queue\Unit\Website\Website</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="TS\Queue\Unit\Website\Website" type="TNW\Salesforce\Synchronize\Queue\Unit">
        <arguments>
            <argument name="code" xsi:type="string">websiteWebsite</argument>
            <argument name="description" xsi:type="string" translatable="true">Website ({{identifier|website}}). Synchronization as an Salesforce Website</argument>
            <argument name="entityType" xsi:type="string">website</argument>
            <argument name="objectType" xsi:type="string">tnw_mage_basic__Magento_Website__c</argument>
            <argument name="generators" xsi:type="array">
                <item name="website" xsi:type="object">TNW\Salesforce\Synchronize\Queue\Website\CreateByWebsite</item>
                <item name="customer" xsi:type="object">TNW\Salesforce\Synchronize\Queue\Website\CreateByCustomer</item>
            </argument>
        </arguments>
    </virtualType>

    <type name="Magento\Framework\Console\CommandList">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="tnw_salesforce_clean_system_logs_command" xsi:type="object">TNW\Salesforce\Console\Command\CleanSystemLogsCommand</item>
                <item name="RefreshSalesforceDataOnGrids" xsi:type="object">TNW\Salesforce\Console\Command\RefreshSalesforceDataOnGrids</item>
            </argument>
        </arguments>
    </type>

    <type name="TNW\Salesforce\Synchronize\Queue\DependenciesQueue">
        <arguments>
            <argument name="queueAddPool" xsi:type="array">
                <item name="website" xsi:type="object">TNW\Salesforce\Synchronize\Queue\Website</item>
                <item name="customer" xsi:type="object">TNW\Salesforce\Synchronize\Queue\Customer</item>
            </argument>
        </arguments>
    </type>

    <type name="TNW\Salesforce\Synchronize\Unit\ProcessingAbstract">
        <plugin name="tnw_salesforce" type="TNW\Salesforce\Plugin\Synchronize\Unit\ProcessingAbstract" />
    </type>

    <preference for="TNW\Salesforce\Api\MessageQueue\PublisherAdapter" type="TNW\Salesforce\MessageQueue\PublisherAdapter"/>
    <type name="TNW\Salesforce\MessageQueue\PublisherAdapter">
        <arguments>
            <argument name="publisher" xsi:type="object">Magento\Framework\MessageQueue\PublisherInterface\Proxy</argument>
        </arguments>
    </type>

    <type name="TNW\Salesforce\Service\MessageQueue\RestartConsumers">
        <arguments>
            <argument name="publisher" xsi:type="object">Magento\Framework\MessageQueue\PublisherInterface\Proxy</argument>
            <argument name="topics" xsi:type="array">
                <item name="tnw_salesforce.sync.realtime" xsi:type="string">tnw_salesforce.sync.realtime</item>
                <item name="tnw_salesforce.prequeue.process" xsi:type="string">tnw_salesforce.prequeue.process</item>
            </argument>
        </arguments>
    </type>

    <type name="\TNW\Salesforce\Synchronize\Entity\DivideEntityByWebsiteOrg">
        <plugin name="tnw_salesforce"
                type="TNW\Salesforce\Plugin\FixMissedWebsites"/>
    </type>

    <type name="TNW\Salesforce\Synchronize\Queue\Website\CreateByBase">
        <plugin name="tnw_salesforce"
            type="TNW\Salesforce\Plugin\Synchronize\Queue\Website\FixMissedWebsites"/>
    </type>

    <type name="TNW\Salesforce\Model\Customer\Config">
        <arguments>
            <argument name="configPathMap" xsi:type="array">
                <item name="tnwsforce_customer/general/default_owner" xsi:type="string">tnwsforce_customer/general/default_owner</item>
            </argument>
        </arguments>
    </type>
    <virtualType name="CustomerGetIdsFilteredByCustomerGroupConfiguration" type="TNW\Salesforce\Service\CustomerGroupConfiguration\GetFilteredIds">
        <arguments>
            <argument name="entityType" xsi:type="string">Customer</argument>
            <argument name="getSelect" xsi:type="object">TNW\Salesforce\Service\CustomerGroupConfiguration\Customer\GetSelect</argument>
        </arguments>
    </virtualType>
    <virtualType name="CustomerSkipByCustomerGroupConfiguration" type="TNW\Salesforce\Synchronize\Queue\SkipRules\SkipByCustomerGroupConfiguration">
        <arguments>
            <argument name="getIdsFilteredByCustomerGroupConfiguration" xsi:type="object">CustomerGetIdsFilteredByCustomerGroupConfiguration</argument>
        </arguments>
    </virtualType>
    <virtualType name="OrderGetIdsFilteredByCustomerGroupConfiguration" type="TNW\Salesforce\Service\CustomerGroupConfiguration\GetFilteredIds">
        <arguments>
            <argument name="entityType" xsi:type="string">Order</argument>
            <argument name="getSelect" xsi:type="object">TNW\Salesforce\Service\CustomerGroupConfiguration\Order\GetSelect</argument>
        </arguments>
    </virtualType>
    <virtualType name="OrderSkipByCustomerGroupConfiguration" type="TNW\Salesforce\Synchronize\Queue\SkipRules\SkipByCustomerGroupConfiguration">
        <arguments>
            <argument name="getIdsFilteredByCustomerGroupConfiguration" xsi:type="object">OrderGetIdsFilteredByCustomerGroupConfiguration</argument>
        </arguments>
    </virtualType>
    <virtualType name="QuoteGetIdsFilteredByCustomerGroupConfiguration" type="TNW\Salesforce\Service\CustomerGroupConfiguration\GetFilteredIds">
        <arguments>
            <argument name="entityType" xsi:type="string">Quote</argument>
            <argument name="getSelect" xsi:type="object">TNW\Salesforce\Service\CustomerGroupConfiguration\Quote\GetSelect</argument>
        </arguments>
    </virtualType>
    <virtualType name="QuoteSkipByCustomerGroupConfiguration" type="TNW\Salesforce\Synchronize\Queue\SkipRules\SkipByCustomerGroupConfiguration">
        <arguments>
            <argument name="getIdsFilteredByCustomerGroupConfiguration" xsi:type="object">QuoteGetIdsFilteredByCustomerGroupConfiguration</argument>
        </arguments>
    </virtualType>
    <virtualType name="QuoteItemGetIdsFilteredByCustomerGroupConfiguration" type="TNW\Salesforce\Service\CustomerGroupConfiguration\GetFilteredIds">
        <arguments>
            <argument name="entityType" xsi:type="string">QuoteItem</argument>
            <argument name="getSelect" xsi:type="object">TNW\Salesforce\Service\CustomerGroupConfiguration\QuoteItem\GetSelect</argument>
        </arguments>
    </virtualType>
    <virtualType name="QuoteItemSkipByCustomerGroupConfiguration" type="TNW\Salesforce\Synchronize\Queue\SkipRules\SkipByCustomerGroupConfiguration">
        <arguments>
            <argument name="getIdsFilteredByCustomerGroupConfiguration" xsi:type="object">QuoteItemGetIdsFilteredByCustomerGroupConfiguration</argument>
        </arguments>
    </virtualType>
    <virtualType name="InvoiceGetIdsFilteredByCustomerGroupConfiguration" type="TNW\Salesforce\Service\CustomerGroupConfiguration\GetFilteredIds">
        <arguments>
            <argument name="entityType" xsi:type="string">Invoice</argument>
            <argument name="getSelect" xsi:type="object">TNW\Salesforce\Service\CustomerGroupConfiguration\Invoice\GetSelect</argument>
        </arguments>
    </virtualType>
    <virtualType name="InvoiceSkipByCustomerGroupConfiguration" type="TNW\Salesforce\Synchronize\Queue\SkipRules\SkipByCustomerGroupConfiguration">
        <arguments>
            <argument name="getIdsFilteredByCustomerGroupConfiguration" xsi:type="object">InvoiceGetIdsFilteredByCustomerGroupConfiguration</argument>
        </arguments>
    </virtualType>
    <virtualType name="ShipmentGetIdsFilteredByCustomerGroupConfiguration" type="TNW\Salesforce\Service\CustomerGroupConfiguration\GetFilteredIds">
        <arguments>
            <argument name="entityType" xsi:type="string">Shipment</argument>
            <argument name="getSelect" xsi:type="object">TNW\Salesforce\Service\CustomerGroupConfiguration\Shipment\GetSelect</argument>
        </arguments>
    </virtualType>
    <virtualType name="ShipmentSkipByCustomerGroupConfiguration" type="TNW\Salesforce\Synchronize\Queue\SkipRules\SkipByCustomerGroupConfiguration">
        <arguments>
            <argument name="getIdsFilteredByCustomerGroupConfiguration" xsi:type="object">ShipmentGetIdsFilteredByCustomerGroupConfiguration</argument>
        </arguments>
    </virtualType>
    <type name="TNW\Salesforce\Synchronize\Queue\Customer\SkipRules\SkipByCustomerGroup">
        <arguments>
            <argument name="skipRulesByQueueLoadFromEntityType" xsi:type="array">
                <item name="customer" xsi:type="object">CustomerSkipByCustomerGroupConfiguration</item>
                <item name="order" xsi:type="object">OrderSkipByCustomerGroupConfiguration</item>
            </argument>
        </arguments>
    </type>
    <type name="TNW\Salesforce\Service\GetFilteredIdsWithoutOrderZeroGrandTotal">
        <arguments>
            <argument name="getSelectProcessors" xsi:type="array">
                <item name="order" xsi:type="object">TNW\Salesforce\Service\ZeroGrandTotalProcessors\Order\GetSelect</item>
                <item name="orderShipment" xsi:type="object">TNW\Salesforce\Service\ZeroGrandTotalProcessors\Shipment\GetSelect</item>
                <item name="orderInvoice" xsi:type="object">TNW\Salesforce\Service\ZeroGrandTotalProcessors\Invoice\GetSelect</item>
            </argument>
        </arguments>
    </type>
    <type name="TNW\Salesforce\Synchronize\Transport\Soap\Calls\Upsert\Storage">
        <plugin name="FormatResponseForArchivedProductsPlugin"
                type="TNW\Salesforce\Plugin\Synchronize\Transport\Soap\Calls\Upsert\Storage\FormatResponseForArchivedProductsPlugin"
        />
    </type>
    <preference for="TNW\Salesforce\Api\Service\Customer\IsSyncDisabledInterface"
                type="TNW\Salesforce\Service\Customer\IsSyncDisabled"/>
    <preference for="TNW\Salesforce\Api\Service\Customer\GetCustomerIdByQuoteIdInterface"
                type="TNW\Salesforce\Service\Customer\GetCustomerIdByQuoteId"/>
    <type name="TNW\Salesforce\Service\GetWebsiteByEntityType">
        <arguments>
            <argument name="processors" xsi:type="array">
                <item name="order" xsi:type="object">TNW\Salesforce\Service\GetWebsiteByEntityType\Order</item>
                <item name="orderItem" xsi:type="object">TNW\Salesforce\Service\GetWebsiteByEntityType\OrderItem</item>
                <item name="customer" xsi:type="object">TNW\Salesforce\Service\GetWebsiteByEntityType\Customer</item>
                <item name="orderInvoice" xsi:type="object">TNW\Salesforce\Service\GetWebsiteByEntityType\Invoice</item>
                <item name="orderShipment" xsi:type="object">TNW\Salesforce\Service\GetWebsiteByEntityType\Shipment</item>
                <item name="store" xsi:type="object">TNW\Salesforce\Service\GetWebsiteByEntityType\Store</item>
                <item name="quote" xsi:type="object">TNW\Salesforce\Service\GetWebsiteByEntityType\Quote</item>
                <item name="quoteItem" xsi:type="object">TNW\Salesforce\Service\GetWebsiteByEntityType\QuoteItem</item>
            </argument>
        </arguments>
    </type>
    <preference for="TNW\Salesforce\Api\Service\Company\GenerateCompanyNameInterface"
                type="TNW\Salesforce\Service\Company\GenerateCompanyName"/>

    <preference for="TNW\Salesforce\Api\Service\Admin\AddUniqueExceptionMessageInterface"
                type="TNW\Salesforce\Service\Admin\AddUniqueExceptionMessage"/>
    <type name="TNW\Salesforce\Service\Admin\AddUniqueExceptionMessage">
        <arguments>
            <argument name="exceptionMessageFactory" xsi:type="object">
                Magento\Framework\Message\ExceptionMessageLookupFactory
            </argument>
        </arguments>
    </type>

    <type name="TNW\Salesforce\Synchronize\Queue\Website\CreateByCustomer">
        <arguments>
            <argument name="resourceCustomer" xsi:type="object">Magento\Customer\Model\ResourceModel\Customer\Proxy</argument>
        </arguments>
    </type>
    <type name="TNW\Salesforce\Synchronize\Queue\Customer\CreateByCustomer">
        <arguments>
            <argument name="resourceCustomer" xsi:type="object">Magento\Customer\Model\ResourceModel\Customer\Proxy</argument>
        </arguments>
    </type>
    <type name="TNW\Salesforce\Service\CleanLocalCacheForInstances">
        <arguments>
            <argument name="instances" xsi:type="array">
                <item name="TNW\Salesforce\Service\Model\ResourceModel\Objects\MassLoadObjectIds" xsi:type="object">
                    TNW\Salesforce\Service\Model\ResourceModel\Objects\MassLoadObjectIds
                </item>
                <item name="TNW\Salesforce\Model\CleanLocalCache\CleanableObjectsList" xsi:type="object">
                    TNW\Salesforce\Model\CleanLocalCache\CleanableObjectsList
                </item>
                <item name="CustomerGetIdsFilteredByCustomerGroupConfiguration" xsi:type="object">
                    CustomerGetIdsFilteredByCustomerGroupConfiguration
                </item>
                <item name="OrderGetIdsFilteredByCustomerGroupConfiguration" xsi:type="object">
                    OrderGetIdsFilteredByCustomerGroupConfiguration
                </item>
                <item name="QuoteGetIdsFilteredByCustomerGroupConfiguration" xsi:type="object">
                    QuoteGetIdsFilteredByCustomerGroupConfiguration
                </item>
                <item name="QuoteItemGetIdsFilteredByCustomerGroupConfiguration" xsi:type="object">
                    QuoteItemGetIdsFilteredByCustomerGroupConfiguration
                </item>
                <item name="InvoiceGetIdsFilteredByCustomerGroupConfiguration" xsi:type="object">
                    InvoiceGetIdsFilteredByCustomerGroupConfiguration
                </item>
                <item name="ShipmentGetIdsFilteredByCustomerGroupConfiguration" xsi:type="object">
                    ShipmentGetIdsFilteredByCustomerGroupConfiguration
                </item>
                <item name="TNW\Salesforce\Service\Customer\IsSyncDisabled" xsi:type="object">
                    TNW\Salesforce\Service\Customer\IsSyncDisabled
                </item>
                <item name="TNW\Salesforce\Synchronize\Queue\Order\Item\SkipRules\SkipByCustomer" xsi:type="object">
                    TNW\Salesforce\Synchronize\Queue\Order\Item\SkipRules\SkipByCustomer
                </item>
                <item name="TNW\Salesforce\Synchronize\Queue\Order\SkipRules\SkipByCustomer" xsi:type="object">
                    TNW\Salesforce\Synchronize\Queue\Order\SkipRules\SkipByCustomer
                </item>
                <item name="TNW\Salesforce\Synchronize\Queue\OrderInvoice\SkipRules\SkipByCustomer" xsi:type="object">
                    TNW\Salesforce\Synchronize\Queue\OrderInvoice\SkipRules\SkipByCustomer
                </item>
                <item name="TNW\Salesforce\Synchronize\Queue\OrderShipment\SkipRules\SkipByCustomer" xsi:type="object">
                    TNW\Salesforce\Synchronize\Queue\OrderShipment\SkipRules\SkipByCustomer
                </item>
                <item name="TNW\Salesforce\Service\Customer\GetCustomerIdByQuoteId" xsi:type="object">
                    TNW\Salesforce\Service\Customer\GetCustomerIdByQuoteId
                </item>
                <item name="TNW\Salesforce\Service\GetWebsiteByEntityType" xsi:type="object">
                    TNW\Salesforce\Service\GetWebsiteByEntityType
                </item>
                <item name="TNW\Salesforce\Service\Product\IsSyncDisabled" xsi:type="object">
                    TNW\Salesforce\Service\Product\IsSyncDisabled
                </item>
                <item name="TNW\Salesforce\Service\CustomerGroupConfiguration\GetCustomerGroupIds" xsi:type="object">
                    TNW\Salesforce\Service\CustomerGroupConfiguration\GetCustomerGroupIds
                </item>
                <item name="TNW\Salesforce\Plugin\Synchronize\Unit\Mapping\CheckOwnerField" xsi:type="object">
                    TNW\Salesforce\Plugin\Synchronize\Unit\Mapping\CheckOwnerField
                </item>
                <item name="TNW\Salesforce\Service\Synchronize\Unit\Load\PreLoadEntities" xsi:type="object">
                    TNW\Salesforce\Service\Synchronize\Unit\Load\PreLoadEntities
                </item>
                <item name="TNW\Salesforce\Service\Synchronize\Unit\Load\GetMappedAttributeCodesByMagentoType" xsi:type="object">
                    TNW\Salesforce\Service\Synchronize\Unit\Load\GetMappedAttributeCodesByMagentoType
                </item>
                <item name="TNW\Salesforce\Service\Synchronize\Unit\Load\GetEntityTypeByCode" xsi:type="object">
                    TNW\Salesforce\Service\Synchronize\Unit\Load\GetEntityTypeByCode
                </item>
                <item name="TNW\Salesforce\Service\Model\ResourceModel\Queue\GetDependenceIdsByEntityType" xsi:type="object">
                    TNW\Salesforce\Service\Model\ResourceModel\Queue\GetDependenceIdsByEntityType
                </item>
                <item name="TNW\Salesforce\Service\Model\ResourceModel\Queue\GetQueuesByIds" xsi:type="object">
                    TNW\Salesforce\Service\Model\ResourceModel\Queue\GetQueuesByIds
                </item>
                <item name="TNW\Salesforce\Service\Synchronize\Unit\Load\SubEntities\Load" xsi:type="object">
                    TNW\Salesforce\Service\Synchronize\Unit\Load\SubEntities\Load
                </item>
                <item name="TNW\Salesforce\Service\Synchronize\Unit\Load\GetCustomersByCustomerIds" xsi:type="object">
                    TNW\Salesforce\Service\Synchronize\Unit\Load\GetCustomersByCustomerIds
                </item>
                <item name="TNW\Salesforce\Service\Synchronize\Unit\Load\GetWebsitesByWebsiteIds" xsi:type="object">
                    TNW\Salesforce\Service\Synchronize\Unit\Load\GetWebsitesByWebsiteIds
                </item>
                <item name="TNW\Salesforce\Service\Synchronize\Queue\Create\GetEntities" xsi:type="object">
                    TNW\Salesforce\Service\Synchronize\Queue\Create\GetEntities
                </item>
                <item name="TNW\Salesforce\Service\Model\Prequeue\Process\GetAvailableSyncTypesByEntityTypes" xsi:type="object">
                    TNW\Salesforce\Service\Model\Prequeue\Process\GetAvailableSyncTypesByEntityTypes
                </item>
                <item name="TNW\Salesforce\Service\Synchronize\Unit\Mapping\GetAttributeFrontedValueFromCache" xsi:type="object">
                    TNW\Salesforce\Service\Synchronize\Unit\Mapping\GetAttributeFrontedValueFromCache
                </item>
                <item name="TNW\Salesforce\Service\Synchronize\Unit\Load\GetCustomerAddressesByAddressIds" xsi:type="object">
                    TNW\Salesforce\Service\Synchronize\Unit\Load\GetCustomerAddressesByAddressIds
                </item>
                <item name="TNW\Salesforce\Model\ResourceModel\Queue\GetDependenceQueueIdsGroupedByCode" xsi:type="object">
                    TNW\Salesforce\Model\ResourceModel\Queue\GetDependenceQueueIdsGroupedByCode
                </item>
                <item name="TNW\Salesforce\Service\Model\Mapper\IsEnabledMapping" xsi:type="object">
                    TNW\Salesforce\Service\Model\Mapper\IsEnabledMapping
                </item>
            </argument>
        </arguments>
    </type>
    <type name="TNW\Salesforce\Service\Model\ResourceModel\Objects\MassLoadObjectIds">
        <arguments>
            <argument name="objectsResource" xsi:type="object">TNW\Salesforce\Model\ResourceModel\Objects\Proxy</argument>
        </arguments>
    </type>
    <type name="TNW\Salesforce\Synchronize\Queue\Unit">
        <arguments>
            <argument name="logger" xsi:type="object">TNW\Logger</argument>
        </arguments>
    </type>
    <type name="TNW\Salesforce\Synchronize\Unit\Entity\Customer\EntityLoader">
        <arguments>
            <argument name="salesforceIdStorage" xsi:type="object">TNW\Salesforce\Model\Entity\Object\Customer</argument>
            <argument name="loaders" xsi:type="array">
                <item name="10" xsi:type="object">CustomersByGetCustomerIdMethodLoader</item>
            </argument>
            <argument name="afterLoadExecutors" xsi:type="array">
                <item name="PreloadAttributesCustomer" xsi:type="object">TNW\Salesforce\Service\Synchronize\Unit\Load\PreloadEntities\PreloadAttributes\Customer</item>
            </argument>
        </arguments>
    </type>

    <virtualType name="CustomersByGetCustomerIdMethodLoader" type="TNW\Salesforce\Service\Synchronize\Unit\Load\Loaders\CustomersByMethodLoader">
        <arguments>
            <argument name="method" xsi:type="const">TNW\Salesforce\Service\Synchronize\Unit\Load\Loaders\CustomersByMethodLoader::GET_CUSTOMER_ID_METHOD</argument>
        </arguments>
    </virtualType>
    <virtualType name="CustomersByGetSuperUserIdMethodLoader" type="TNW\Salesforce\Service\Synchronize\Unit\Load\Loaders\CustomersByMethodLoader">
        <arguments>
            <argument name="method" xsi:type="const">TNW\Salesforce\Service\Synchronize\Unit\Load\Loaders\CustomersByMethodLoader::GET_SUPER_USER_ID_METHOD</argument>
        </arguments>
    </virtualType>
    <type name="TNW\Salesforce\Synchronize\Unit\Customer\Load\Loader\Customer">
        <arguments>
            <argument name="afterLoadExecutors" xsi:type="array">
                <item name="10" xsi:type="object">TNW\Salesforce\Service\Synchronize\Unit\Load\PreloadEntities\PreloadAddresses</item>
                <item name="PreloadAttributesCustomer" xsi:type="object">TNW\Salesforce\Service\Synchronize\Unit\Load\PreloadEntities\PreloadAttributes\Customer</item>
            </argument>
        </arguments>
    </type>

    <virtualType name="TNW\Salesforce\Model\ResourceModel\Objects\Customer\ContactJoin" type="TNW\Salesforce\Model\ResourceModel\Objects\ObjectIdJoin">
        <arguments>
            <argument name="magentoType" xsi:type="string">Customer</argument>
            <argument name="salesforceType" xsi:type="string">Contact</argument>
        </arguments>
    </virtualType>

    <virtualType name="TNW\Salesforce\Model\ResourceModel\Objects\Customer\AccountJoin" type="TNW\Salesforce\Model\ResourceModel\Objects\ObjectIdJoin">
        <arguments>
            <argument name="magentoType" xsi:type="string">Customer</argument>
            <argument name="salesforceType" xsi:type="string">Account</argument>
        </arguments>
    </virtualType>
    <virtualType name="SalesCustomerGridFlatColumnsModifier" type="TNW\Salesforce\Service\Model\Grid\Executor\ByCollection\CreateCollection\ColumnModifier">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="sf_website_id" xsi:type="object">TNW\Salesforce\Model\ResourceModel\Objects\Customer\WebsiteSelect</item>
                <item name="sforce_id" xsi:type="object">TNW\Salesforce\Model\ResourceModel\Objects\Customer\ContactJoin</item>
                <item name="sforce_account_id" xsi:type="object">TNW\Salesforce\Model\ResourceModel\Objects\Customer\AccountJoin</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="CreateCustomerGridFlatGridCollection" type="TNW\Salesforce\Service\Model\Grid\Executor\ByCollection\CreateCollection">
        <arguments>
            <argument name="collectionClassName" xsi:type="string">Magento\Customer\Model\ResourceModel\Grid\Collection</argument>
            <argument name="resource" xsi:type="object">Magento\Customer\Model\ResourceModel\Customer</argument>
            <argument name="modifiers" xsi:type="array">
                <item name="SalesCustomerGridFlatColumnsModifier" xsi:type="object">SalesCustomerGridFlatColumnsModifier</item>
            </argument>
            <argument name="addStatus" xsi:type="boolean">true</argument>
        </arguments>
    </virtualType>
    <virtualType name="GetCustomerGridFlatObjectIdSalesforceColumnData" type="TNW\Salesforce\Service\Model\Grid\Executor\GetColumnDataByCollection">
        <arguments>
            <argument name="createCollection" xsi:type="object">CreateCustomerGridFlatGridCollection</argument>
        </arguments>
    </virtualType>
    <virtualType name="GetCustomerGridFlatSalesforceSyncStatusColumnData" type="TNW\Salesforce\Service\Model\Grid\Executor\GetColumnDataByCollection">
        <arguments>
            <argument name="createCollection" xsi:type="object">CreateCustomerGridFlatGridCollection</argument>
            <argument name="allowNull" xsi:type="boolean">false</argument>
            <argument name="resultType" xsi:type="const">TNW\Salesforce\Service\Model\Grid\Executor\GetColumnDataByCollection::RESULT_TYPE_INT</argument>
        </arguments>
    </virtualType>
    <virtualType name="GetSalesCustomerGridFlatTableColumnsDataItems" type="TNW\Salesforce\Service\Model\Grid\GetColumnsDataItems">
        <arguments>
            <argument name="executors" xsi:type="array">
                <item name="entity_id" xsi:type="object">GetCustomerGridFlatObjectIdSalesforceColumnData</item>
                <item name="sforce_id" xsi:type="object">GetCustomerGridFlatObjectIdSalesforceColumnData</item>
                <item name="sforce_account_id" xsi:type="object">GetCustomerGridFlatObjectIdSalesforceColumnData</item>
                <item name="sforce_sync_status" xsi:type="object">GetCustomerGridFlatSalesforceSyncStatusColumnData</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="UpdateCustomerGridFlatTableByGetColumnData" type="TNW\Salesforce\Service\Model\Grid\UpdateTableByGetColumnData">
        <arguments>
            <argument name="getColumnsDataItems" xsi:type="object">GetSalesCustomerGridFlatTableColumnsDataItems</argument>
            <argument name="tableName" xsi:type="string">customer_grid_flat</argument>
        </arguments>
    </virtualType>

    <type name="TNW\Salesforce\Service\Model\Grid\GetGridUpdatersByEntityTypes">
        <arguments>
            <argument name="gridUpdaters" xsi:type="array">
                <item name="customer" xsi:type="array">
                    <item name="UpdateCustomerGridFlatTableByGetColumnData" xsi:type="object">UpdateCustomerGridFlatTableByGetColumnData</item>
                </item>
            </argument>
        </arguments>
    </type>
    <virtualType name="TNW\Salesforce\Service\Model\Grid\GetColumnsDataItems\CleanableObjectsList" type="TNW\Salesforce\Model\CleanLocalCache\CleanableObjectsList"/>
    <type name="TNW\Salesforce\Service\Model\Grid\GetColumnsDataItems">
        <arguments>
            <argument name="cleanableExecutorsList" xsi:type="object">TNW\Salesforce\Service\Model\Grid\GetColumnsDataItems\CleanableObjectsList</argument>
        </arguments>
    </type>
    <type name="TNW\Salesforce\Service\Model\Grid\UpdateGridsByQueues">
        <arguments>
            <argument name="cleanableExecutorsList" xsi:type="object">TNW\Salesforce\Service\Model\Grid\GetColumnsDataItems\CleanableObjectsList</argument>
        </arguments>
    </type>
    <type name="Symfony\Component\Console\Command\Command">
        <plugin name="tnw_salesforce_console_command_entities_sync" type="TNW\Salesforce\Plugin\Console\Command"/>
    </type>
    <type name="Magento\Framework\MessageQueue\PublisherInterface">
        <plugin name="tnw_salesforce_message_queue_publisher_entities_sync" type="TNW\Salesforce\Plugin\MessageQueue\Publisher"/>
    </type>
</config>
